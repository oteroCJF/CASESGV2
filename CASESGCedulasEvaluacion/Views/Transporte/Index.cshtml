@model CedulasEvaluacion.Entities.MCedula.ModelsIndex
@{
    var i = 0;
    var user = Convert.ToInt32((@User.Claims.ElementAt(2).Value).Contains("Evaluador"));
    <div class="titulo-principal">
        <b>Listado de Cédulas del Servicio de Transporte para Personas Servidoras Públicas</b> <i class="fa-sharp fa-solid fa-bus-school mr-2"></i>
    </div>
    //ViewData["Title"] = "Transporte para Personas Servidoras Públicas";
}

<div class="col-md-10 d-flex">
    <div class="col-md-6 d-flex align-items-stretch">
        <div class="card w-100 card-transport-bg">
            <div class="row no-gutters">
                <div class="col-9">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-12">
                                <h6 class="card-subtitle mb-2"><strong>Contrato Anterior:</strong></h6>
                                <h6 class="card-subtitle mb-2"><span style="color: darkblue; font-size: 1.05em;"><strong>CON/DGRM/DCS/063/2024</strong></span></h6>
                                <br>
                                <h6 class="card-subtitle mb-2"><strong>Vigencia:</strong></h6>
                                <h6 class="card-subtitle mb-2">Del 08 de abril 2024 al 31 de diciembre 2024</h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-6 d-flex align-items-stretch">
        <div class="card w-100 bg-gray-light card-transport-bg">
            <div class="row no-gutters">
                <div class="col-9">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-12">
                                <h6 class="card-subtitle mb-2"><strong>Nuevo Contrato:</strong></h6>
                                <h6 class="card-subtitle mb-2"><span style="color: red; font-size: 1.05em;"><strong>CON/DGRM/DCS/065/2025</strong></span></h6>
                                <br>
                                <h6 class="card-subtitle mb-2"><strong>Vigencia:</strong></h6>
                                <h6 class="card-subtitle mb-2">Del 20 de marzo 2025 al 31 de diciembre 2025</h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="container-fluid">
    <div class="row">
        <section class="col-xl-10 connectedSortable">
            <div class="card">
                <div class="card-header text-white text-center py-3 shadow-sm" style="background-color: #24135f;">
                    <h3 class="card-title mb-0 fs-4 fw-bold text-uppercase">
                        <i class="fas fa-clipboard-list me-3 mr-2 "></i> <strong>Cédulas de Evaluación</strong>
                    </h3>
                </div>
                <div class="card-body" style="font-size: 15px;">
                    <p class="mb-0">
                        <strong>NOTA:</strong> Para el estatus <strong class="text-danger">Rechazado</strong>, debes seleccionar el ícono <i class="fas fa-pencil-alt text-primary"></i> para editar el cuestionario. Luego, envíalo nuevamente a la DAS con las correcciones solicitadas para su revisión.
                    </p>
                    <table id="tblIncidencias" class="table table-hover table-striped table-bordered table-sm" width="100%">
                        <thead style="background-color: #24135f; color: white;">
                            <tr>
                                <th class="text-center">#</th>
                                <th class="text-center">Estatus</th>
                                <th class="text-center">Inmueble</th>
                                <th class="text-center">Folio</th>
                                <th class="text-center">Mes</th>
                                <th class="text-center">Año</th>
                                <th class="text-center">Calif</th>
                                @if (!(@User.Claims.ElementAt(2).Value).Contains("Evaluador"))
                                {
                                    <th class="text-center">Validaciones</th>
                                }
                                <th class="text-center">Actualizado el:</th>
                                <th class="text-center">Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.cedulas)
                            {
                                i++;
                                <tr>

                                    <td class="text-center align-middle">@i</td>
                                    <td class="@(item.Fondo.Replace("bg","text")) text-center align-middle" style="font-weight: bold">@Html.DisplayFor(modelItem => item.Estatus)</td>
                                    <td class="text-center align-middle">@Html.DisplayFor(modelItem => item.Nombre)</td>
                                    <td class="text-center align-middle">
                                        @{ string folio = item.Folio.ToString();
                                            string classToApply = "";
                                            if (folio.Contains("N", StringComparison.OrdinalIgnoreCase)) // Usamos OrdinalIgnoreCase para que detecte 'n' o 'N'
                                            {
                                                classToApply = "text-danger-highlight"; // Esta es la clase CSS que crearemos
                                            } }
                                        <span class="@classToApply">@folio</span>
                                    </td>
                                    <td class="text-center align-middle">@Html.DisplayFor(modelItem => item.Mes)</td>
                                    <td class="text-center align-middle">@Html.DisplayFor(modelItem => item.Anio)</td>
                                    <td class="text-center @(item.Calificacion < 8 ? "text-danger font-weight-bold" : "")">
                                        @Html.DisplayFor(modelItem => item.Calificacion)
                                    </td>


                                    @if (!(@User.Claims.ElementAt(2).Value).Contains("Evaluador") &&
                           (item.Estatus.Equals("En Trámite") || item.Estatus.Equals("Trámite de Pago") || item.Estatus.Equals("Enviada a DGPPT") || item.Estatus.Equals("Pagada")))
                                    {
                                        <td class="text-center align-middle">
                                            @if (item.MemoValidado == true)
                                            {
                                                <i class="fa-regular fa-check text-success mr-2" data-toggle="tooltip" title="Memorándum validado" data-placement="top"></i>
                                            }
                                            else
                                            {
                                                <i class="fa-regular fa-clipboard-check text-danger mr-2" data-toggle="tooltip" title="Memorándum pendiente de validar" data-placement="top"></i>
                                            }

                                            @if (item.CedulaValidada == true)
                                            {
                                                <i class="fa-regular fa-check text-success mr-2" data-toggle="tooltip" title="Cédula validada" data-placement="top"></i>
                                            }
                                            else
                                            {
                                                <i class="fa-regular fa-clipboard-check text-danger mr-2" data-toggle="tooltip" title="Cédula pendiente de validar" data-placement="top"></i>
                                            }

                                            @if (item.ActaFirmada == true)
                                            {
                                                <i class="fa-regular fa-file-check text-success" data-toggle="tooltip" title="Acta Entrega - Recepción" data-placement="top"></i>
                                            }
                                            else
                                            {
                                                <i class="fa-regular fa-file-xmark text-danger" data-toggle="tooltip" title="Acta Entrega - Recepción pendiente de validar" data-placement="top"></i>
                                            }
                                        </td>
                                    }
                                    else if (!(@User.Claims.ElementAt(2).Value).Contains("Evaluador") && !item.Estatus.Equals("En Trámite"))
                                    {
                                        @if (item.MemoValidado == true && item.CedulaValidada == true)
                                        {
                                            <td class="text-center align-middle">
                                                <i class="fa-regular fa-check text-success"></i>
                                                <i class="fa-regular fa-check text-success"></i>
                                            </td>
                                        }
                                        else
                                        {
                                            <td class="text-center align-middle">
                                                <i class="fa-regular fa-user-clock text-primary"></i>
                                            </td>
                                        }
                                    }
                                    <td class="text-center align-middle">@item.FechaActualizacion.ToString("dd/MM/yyyy hh:mm tt")</td>
                                    <td class="text-center align-middle">
                                        @if (!item.Estatus.Equals("En Proceso") && !(@User.Claims.ElementAt(2).Value).Contains("Evaluador"))
                                        {
                                            <a href="#" data-id="@item.Id" class="text-center btnRevision" data-toggle="tooltip" title="Revisar Cédula" data-placement="top">
                                                <i class="fad fa-eye text-success"></i>
                                            </a>
                                        }
                                        @if (item.Estatus.Equals("Rechazada") || item.Estatus.Equals("En Proceso") || !(@User.Claims.ElementAt(2).Value).Contains("Evaluador"))
                                        {
                                            <a href="#" data-id="@item.Id" class="text-center ml-2 btnCuestionario" data-toggle="tooltip" title="Modificar Cédula" data-placement="top">
                                                <i class="fad fa-pencil text-primary"></i>
                                            </a>
                                        }
                                        @if (item.Estatus.Equals("En Proceso"))
                                        {
                                            <a href="#" class="text-center ml-2 delete_cedula" data-id="@item.Id" data-folio="@item.Folio" data-toggle="tooltip" title="Eliminar Cédula" data-placement="top">
                                                <i class="fad fa-times text-danger"></i>
                                            </a>
                                        }
                                        @*@if (!item.Estatus.Equals("En Proceso"))
                         {
                              <a href="#" data-id="@item.Id" data-estatus="@item.Estatus" data-servicio="@item.ServicioId" data-inmueble="@item.InmuebleId" class="text-center pdf ml-2 btn_pdf" data-toggle="tooltip" title="Generar Cédula" data-placement="top">

                                  @if (item.Estatus.Equals("Autorizada") || item.Estatus.Equals("En Trámite"))
                                  {

                                     <i class="fal fa-file-pdf text-success"></i>

                                     <a href="#" data-id="@item.Id" class="text-center btnRevision" data-toggle="tooltip" title="Revisar Cédula" data-placement="top">
                                         <i class="fad fa-eye text-success"></i>
                                     </a>

                                   }  else @if (item.Estatus.Equals("Rechazada")){
                                      <i class="fal fa-file-pdf text-danger"></i>
                                   }  else {
                                      <i class="fal fa-file-pdf text-primary"></i>
                                   }
                              </a>
                        }*@
                                        @if (!item.Estatus.Equals("En Proceso"))
                                        {
                                            <a href="#"
                                               data-id="@item.Id"
                                               data-estatus="@item.Estatus"
                                               data-servicio="@item.ServicioId"
                                               data-inmueble="@item.InmuebleId"
                                               data-anio="@item.Anio" @* <--- ¡CAMBIO AQUÍ! Usa item.Anio *@
                                               data-mes="@item.Mes" @* <--- ¡CAMBIO AQUÍ! Usa item.Mes *@
                                               class="text-center pdf ml-2 @((item.Anio > 2025 || (item.Anio == 2025 && (item.Mes == "Marzo" || item.Mes == "Abril" || item.Mes == "Mayo" || item.Mes == "Junio" || item.Mes == "Julio" || item.Mes == "Agosto" || item.Mes == "Septiembre" || item.Mes == "Octubre" || item.Mes == "Noviembre" || item.Mes == "Diciembre"))) ? "btn_pdfNC" : "btn_pdf")"
                                               data-toggle="tooltip"
                                               title="Generar Cédula"
                                               data-placement="top">

                                                @if (item.Estatus.Equals("Autorizada") || item.Estatus.Equals("En Trámite"))
                                                {
                                                    <i class="fal fa-file-pdf text-success"></i>

                                                    <a href="#" data-id="@item.Id" class="text-center btnRevision" data-toggle="tooltip" title="Revisar Cédula" data-placement="top">
                                                        <i class="fad fa-eye text-success"></i>
                                                    </a>
                                                }
                                                else if (item.Estatus.Equals("Rechazada"))
                                                {
                                                    <i class="fal fa-file-pdf text-danger"></i>
                                                }
                                                else
                                                {
                                                    <i class="fal fa-file-pdf text-primary"></i>
                                                }
                                            </a>
                                        }

                                        @if (!item.Estatus.Equals("En Proceso") && !item.Estatus.Equals("Enviado a DAS"))
                                        {
                                            <a href="#" data-id="@item.Id" class="text-center ml-2 btnSeguimiento" data-toggle="tooltip" title="Seguimiento a la Cédula" data-placement="top">
                                                <i class="fas fa-file-import text-primary"></i>
                                            </a>
                                        }
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        <section class="col-xl-2 connectedSortable">
            <div class="card">
                <div class="card-header text-white text-center py-3 shadow-sm" style="background-color: #24135f;">
                    <h3 class="card-title">
                        <strong>FILTROS DE BÚSQUEDA</strong>
                        <button id="recargarPagina" class="btn btn-success" data-toggle="tooltip" title="Reiniciar Filtros">
                            <i class="fa-regular fa-arrows-rotate"></i>
                        </button>
                    </h3>
                </div>
                <div class="card-body" style="font-size: 14px;">
                    <div class="row col-lg-12">
                        <div class="col-lg-12">
                            <b>Año:</b>
                            <a class="btn-sm bg-primary btnAnios float-right" data-target="#btnAnio" data-toggle="collapse">
                                <i class="fas fa-minus"></i>
                            </a>
                        </div>
                        @foreach (var an in Model.anios)
                        {
                            <div class="col-lg-12 show ml-3" id="btnAnio">
                                <label class="checkbox-inline">
                                    @if (Model.filtroAnios.Contains(an.Valor))
                                    {
                                        <input class="selectAnio" id="anio_@an.Valor" type="checkbox" data-toggle="toggle"
                                               data-on="<i class='fa fa-check' style='margin-top: -2px;'></i>"
                                               data-off="<i class='fa fa-times' style='margin-top: -2px;'></i>" data-size="mini"
                                               data-onstyle="success" data-offstyle="danger" data-style="ios" value="@an.Valor" checked> @an.Valor
                                        }
                                        else
                                        {
                                            <input class="selectAnio" id="anio_@an.Valor" type="checkbox" data-toggle="toggle"
                                                   data-on="<i class='fa fa-check' style='margin-top: -2px;'></i>"
                                                   data-off="<i class='fa fa-times' style='margin-top: -2px;'></i>" data-size="mini"
                                                   data-onstyle="success" data-offstyle="danger" data-style="ios" value="@an.Valor"> @an.Valor
                                            }
                                </label>
                            </div>
                        }
                    </div>


                    <div class="row col-lg-12 mt-2">
                        <div class="col-lg-12">
                            <b>Mes:</b>
                            <a class="btn-sm bg-primary btnMeses float-right" data-target="#btnMes" data-toggle="collapse">
                                <i class="fas fa-minus"></i>
                            </a>
                        </div>
                        @foreach (var an in Model.Meses)
                        {
                            <div class="col-lg-12 show ml-3" id="btnMes">
                                <label class="checkbox-inline float-left">
                                    @if (Model.filtroMeses.Contains(an.Mes))
                                    {
                                        <input class="selectMes" id="mes_@an.Mes" type="checkbox" data-toggle="toggle"
                                               data-on="<i class='fa fa-check' style='margin-top: -2px;'></i>"
                                               data-off="<i class='fa fa-times' style='margin-top: -2px;'></i>" data-size="mini"
                                               data-onstyle="success" data-offstyle="danger" data-style="ios" value="@an.Mes" checked> @an.Mes
                                        }
                                        else
                                        {
                                            <input class="selectMes" id="mes_@an.Mes" type="checkbox" data-toggle="toggle"
                                                   data-on="<i class='fa fa-check' style='margin-top: -2px;'></i>"
                                                   data-off="<i class='fa fa-times' style='margin-top: -2px;'></i>" data-size="mini"
                                                   data-onstyle="success" data-offstyle="danger" data-style="ios" value="@an.Mes"> @an.Mes
                                            }
                                </label>
                            </div>
                        }
                    </div>
                    <div class="row col-lg-12 mt-2">
                        <div class="col-lg-12">
                            <b>Estatus:</b>
                            <a class="btn-sm bg-primary btnEstatuss float-right" data-target="#btnEstatus" data-toggle="collapse">
                                <i class="fas fa-minus"></i>
                            </a>
                        </div>
                        @foreach (var an in Model.festatus)
                        {
                            <div class="col-lg-12 show ml-3" id="btnEstatus">
                                <label class="checkbox-inline">
                                    @if (Model.filtroEstatus.Contains(an.Estatus))
                                    {
                                        <input class="selectEstatus" type="checkbox" data-toggle="toggle"
                                               data-on="<i class='fa fa-check' style='margin-top: -2px;'></i>"
                                               data-off="<i class='fa fa-times' style='margin-top: -2px;'></i>" data-size="mini"
                                               data-onstyle="success" data-offstyle="danger" data-style="ios" value="@an.Estatus" checked> @an.Estatus
                                        }
                                        else
                                        {
                                            <input class="selectEstatus" type="checkbox" data-toggle="toggle"
                                                   data-on="<i class='fa fa-check' style='margin-top: -2px;'></i>"
                                                   data-off="<i class='fa fa-times' style='margin-top: -2px;'></i>" data-size="mini"
                                                   data-onstyle="success" data-offstyle="danger" data-style="ios" value="@an.Estatus"> @an.Estatus
                                            }
                                </label>
                            </div>
                        }
                    </div>
                    <div class="row col-lg-12 mt-2">
                        <div class="col-lg-12">
                            <b>Administración:</b>
                            <a class="btn-sm bg-primary btnAdmins float-right" data-target="#btnAdmin" data-toggle="collapse">
                                <i class="fas fa-plus"></i>
                            </a>
                        </div>
                        @foreach (var an in Model.administraciones)
                        {
                            <div class="col-lg-12 collapse" id="btnAdmin" style="font-size: 12px;">
                                <label class="checkbox-inline">
                                    @if (Model.filtroAdmins.Contains(an.Id + ""))
                                    {
                                        <input class="selectAdmin" id="admin_@an.Nombre" type="checkbox" data-toggle="toggle"
                                               data-on="<i class='fa fa-check' style='margin-top: -2px;'></i>"
                                               data-off="<i class='fa fa-times' style='margin-top: -2px;'></i>" data-size="mini"
                                               data-onstyle="success" data-offstyle="danger" data-style="ios" value="@an.Id" checked> @an.Abreviacion
                                        }
                                        else
                                        {
                                            <input class="selectAdmin" id="admin_@an.Nombre" type="checkbox" data-toggle="toggle"
                                                   data-on="<i class='fa fa-check' style='margin-top: -2px;'></i>"
                                                   data-off="<i class='fa fa-times' style='margin-top: -2px;'></i>" data-size="mini"
                                                   data-onstyle="success" data-offstyle="danger" data-style="ios" value="@an.Id"> @an.Abreviacion
                                            }
                                </label>
                            </div>
                        }
                    </div>
                    <div class="row col-lg-12 mt-2" id="divInmuebles">
                        <div class="col-lg-12">
                            <b>Inmuebles:</b>
                            <a class="btn-sm bg-primary btnInmuebles float-right" data-target="#btnInmueble" data-toggle="collapse">
                                <i class="fas fa-plus"></i>
                            </a>
                        </div>
                        @foreach (var an in Model.inmuebles)
                        {
                            <div class="col-lg-12 collapse inm_@an.AdministracionId" id="btnInmueble" style="font-size: 12px;">
                                <label class="checkbox-inline">
                                    @if (Model.filtroInmuebles.Contains(an.Nombre))
                                    {
                                        <input class="selectInmueble" id="inm_@an.Nombre" type="checkbox" data-toggle="toggle"
                                               data-on="<i class='fa fa-check' style='margin-top: -2px;'></i>"
                                               data-off="<i class='fa fa-times' style='margin-top: -2px;'></i>" data-size="mini"
                                               data-onstyle="success" data-offstyle="danger" data-style="ios" value="@an.Nombre" checked> @an.Abreviacion
                                        }
                                        else
                                        {
                                            <input class="selectInmueble" id="inm_@an.Nombre" type="checkbox" data-toggle="toggle"
                                                   data-on="<i class='fa fa-check' style='margin-top: -2px;'></i>"
                                                   data-off="<i class='fa fa-times' style='margin-top: -2px;'></i>" data-size="mini"
                                                   data-onstyle="success" data-offstyle="danger" data-style="ios" value="@an.Nombre"> @an.Abreviacion
                                            }
                                </label>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>


@*************MODAL DE AVISO MARZO*****@
@*<div class="modal fade" id="miModal" tabindex="-1" role="dialog" aria-labelledby="miModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content" style="background-color: #ffffff;">
            <div class="modal-header" style="background-color: #24135f; color: white;">
                <h5 class="modal-title" id="miModalLabel">¡IMPORTANTE!</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar" style="color: white;">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="color: #333;">
                <span style="color: black; font-weight: bold;">Para la evaluación del mes de Marzo, se encontrarán 2 cédulas correspondientes al mismo inmueble.</span>
                <br>Para diferenciarlas se utilizará la letra "N" el la terminación del Folio.
                <br>
                <span style="color: #24135f; font-weight: bold;">La Nueva Cédula de Marzo correspondiente al Nuevo Contrato se encuentra</span> <span style="color: red; font-weight: bold;">resaltada en color rojo</span> <span style="color: #24135f; font-weight: bold;">para su fácil identificación.</span>
                <div style="text-align: center;">
                    <img src="~/dist/img/logos/NuevaCedulaMarzoTransporte.png" class="img-fluid" alt="Nueva Cedula Ejemplo">
                    <br>
                    <span style="color: red; font-weight: bold;">LA EVALUACIÓN DE ÉSTA COMPRENDE EL SERVICIO DEL 20 AL 31 DE MARZO</span>

                </div>
            </div>
            <div class="modal-footer" style="background-color: #e0d4ff;">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" style="background-color: #24135f; border-color: #5e35b1; ">Entendido</button>
            </div>
        </div>
    </div>
</div>*@

<style>
    .dataTables_filter {
        display: block;
    }

    #recargarPagina {
        cursor: pointer;
        font-size: 12px; /* Ajusta el tamaño de la fuente según tus necesidades */
        padding: 3px 6px;
        border-radius: 50px;
        transition: background-color 0.3s ease;
    }

    .text-danger-highlight {
        color: #dc3545; /* Rojo de Bootstrap */
        font-weight: bold; /* Opcional: para que resalte más */
    }

    .titulo-principal {
        font-family: Arial, sans-serif;
        font-size: 24px;
        color: #24135f;
        text-align: left;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        animation: fadeIn 2s ease-in-out;
        font-weight: bold;
        position: relative; /* Agrega esta línea */
        top: -20px; /* Ajusta el valor según sea necesario */
        right: -10px;
    }

    @@keyframes fadeIn {
        from {
            opacity: 0;
        }

        to {
            opacity: 1;
        }
    }

    .example-1 {
        position: relative;
        overflow-y: scroll;
        height: 300px;
        display: none;
    }
</style>

@section Scripts{
    <script>
        $(function () {
            var model = @Html.Raw(Json.Serialize(@Model));
            var idUsuario = @User.Claims.ElementAt(0).Value;

            var anios = [];
            var meses = [];
            var est = [];
            var admin = [];
            var admin2 = [];
            var inmuebles = [];

            $('[data-toggle="tooltip"]').tooltip();

            localStorage.clear();

            $(".btnRevision").click(function () {
                window.location.href = "/transporte/revision/" + $(this).data('id') + "?Anio=" + anios + "&Mes=" + meses
                    + "&Estatus=" + est + "&administracion=" + admin + "&Inmueble=" + inmuebles;
            });

            $(".btnSeguimiento").click(function () {
                window.location.href = "/transporte/seguimiento/" + $(this).data('id') + "?Anio=" + anios + "&Mes=" + meses
                    + "&Estatus=" + est + "&administracion=" + admin + "&Inmueble=" + inmuebles;
            });

            $(".btnCuestionario").click(function () {
                window.location.href = "/transporte/evaluacion/" + $(this).data('id') + "?Anio=" + anios + "&Mes=" + meses
                    + "&Estatus=" + est + "&administracion=" + admin + "&Inmueble=" + inmuebles;
            });

            document.getElementById("recargarPagina").addEventListener("click", function () {
                location.reload();
            });
             /********************************** Filtros AJAX ***********************************/
                $('#tblIncidencias').DataTable({
                    dom: 'lBfrtip',
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            title: 'Servicio de Transporte para Servidores Públicos - Listado de Oficios Capturados',
                            className: "btn-sm bg-cjf mr-1",
                        },
                        {
                            extend: 'pdfHtml5',
                            title: 'Servicio de Transporte para Servidores Públicos - Listado de Oficios Capturados',
                            className: "btn-sm bg-cjf mr-1"
                        },
                        {
                            extend: 'print',
                            title: 'Servicio de Transporte para Servidores Públicos - Listado de Oficios Capturados',
                            text: 'Imprimir',
                            className: "btn-sm bg-cjf mr-1"
                        },
                        /*{
                            extend: 'colvis',
                            text: 'Ocultar Columnas',
                            className: "bg-cjf"
                        }*/],
                    //"bFilter": false,
                    lengthMenu: [[35, 50, 100, -1], [35, 50, 100, "Todos"]],
                    responsive: true,
                    language: {
                        url: "//cdn.datatables.net/plug-ins/1.10.19/i18n/Spanish.json"
                    },
                });

                var table = $('#tblIncidencias').DataTable();

                $('.selectAnio').on('change', function () {
                    anios = [];
                    $(".selectAnio").each(function () {
                    var activo = $(this).parent().hasClass("off");
                    if (activo == false) {
                        anios.push($(this).val());
                    }
                });

                    var mergedVal = anios.join('|');
                    table.column(5).search(mergedVal, true).draw();
                });

                $('.selectMes').on('change', function () {
                    meses = [];
                    $(".selectMes").each(function () {
                    var activo = $(this).parent().hasClass("off");
                    if (activo == false) {
                        meses.push($(this).val());
                    }
                });
                    var mergedVal = meses.join('|');
                    table.column(4).search(mergedVal, true).draw();
                });

                $('.selectEstatus').on('change', function () {
                    est = [];
                    $(".selectEstatus").each(function () {
                    var activo = $(this).parent().hasClass("off");
                    if (activo == false) {
                        est.push($(this).val());
                    }
                });

                    var mergedVal = est.join('|').replace("&", "\\&").replace(/\s/g, "\\s");
                    table.column(1).search(mergedVal, true).draw();
                });

                $('.selectAdmin').on('change', function () {
                    admin = [];
                    admin2 = [];
                    $(".selectAdmin").each(function () {
                    var activo = $(this).parent().hasClass("off");
                    if (activo == false) {
                        admin.push($(this).val());
                    }
                    admin2.push($(this).val());
                });

                    for (let i = 0; i < admin2.length; i++) {
                        $(".inm_" + admin2[i]).hide();
                    }

                    if (!$("#divInmuebles > #btnInmueble").hasClass("show")) {
                        $(".btnInmuebles").trigger("click");
                    }

                    if (admin.length > 0) {
                        for (let i = 0; i < admin.length; i++) {
                            $(".inm_" + admin[i]).show();
                        }
                    } else {
                        for (let i = 0; i < admin2.length; i++) {
                            $(".inm_" + admin2[i]).show();
                        }
                    }

                });

                $('.selectInmueble').on('change', function () {
                    inmuebles = [];
                    $(".selectInmueble").each(function () {
                    var activo = $(this).parent().hasClass("off");
                    if (activo == false) {
                        inmuebles.push($(this).val());
                    }
                    });
                    var mergedVal = inmuebles.join('|').replace("&", "\\&").replace(/\s/g, "\\s");
                    table.column(2).search(mergedVal, true).draw();
                });

                $(".btnAnios").click(function () {
                    if ($(".btnAnios > i").hasClass("fas fa-plus")) {
                        $(".btnAnios > i").removeClass("fas fa-plus");
                        $(".btnAnios > i").addClass("fas fa-minus");
                    } else {
                        $(".btnAnios > i").removeClass("fas fa-minus");
                        $(".btnAnios > i").addClass("fas fa-plus");
                    }
                });

                $(".btnMeses").click(function () {
                    if ($(".btnMeses > i").hasClass("fas fa-plus")) {
                        $(".btnMeses > i").removeClass("fas fa-plus");
                        $(".btnMeses > i").addClass("fas fa-minus");
                    } else {
                        $(".btnMeses > i").removeClass("fas fa-minus");
                        $(".btnMeses > i").addClass("fas fa-plus");
                    }
                });

                $(".btnAdmins").click(function () {
                    if ($(".btnAdmins > i").hasClass("fas fa-plus")) {
                        $(".btnAdmins > i").removeClass("fas fa-plus");
                        $(".btnAdmins > i").addClass("fas fa-minus");
                    } else {
                        $(".btnAdmins > i").removeClass("fas fa-minus");
                        $(".btnAdmins > i").addClass("fas fa-plus");
                    }
                });

                $(".btnInmuebles").click(function () {
                    if ($(".btnInmuebles > i").hasClass("fas fa-plus")) {
                        $(".btnInmuebles > i").removeClass("fas fa-plus");
                        $(".btnInmuebles > i").addClass("fas fa-minus");
                    } else {
                        $(".btnInmuebles > i").removeClass("fas fa-minus");
                        $(".btnInmuebles > i").addClass("fas fa-plus");
                    }
                });

                $(".btnEstatuss").click(function () {
                    if ($(".btnEstatuss > i").hasClass("fas fa-plus")) {
                        $(".btnEstatuss > i").removeClass("fas fa-plus");
                        $(".btnEstatuss > i").addClass("fas fa-minus");
                    } else {
                        $(".btnEstatuss > i").removeClass("fas fa-minus");
                        $(".btnEstatuss > i").addClass("fas fa-plus");
                    }
                });

                if (model.filtroAnios != "") {
                    anios = [];
                    $(".selectAnio").each(function () {
                        var activo = $(this).parent().hasClass("off");
                        if (activo == false) {
                            anios.push($(this).val());
                        }
                    });

                    var mergedVal = anios.join('|');
                    table.column(5).search(mergedVal, true).draw();
                }

                if (model.filtroMeses!= "") {
                    meses = [];
                    $(".selectMes").each(function () {
                        var activo = $(this).parent().hasClass("off");
                        if (activo == false) {
                            meses.push($(this).val());
                        }
                    });
                    var mergedVal = meses.join('|');
                    table.column(4).search(mergedVal, true).draw();
                }

                if (model.filtroAdmins != "") {
                    admin = [];
                    admin2 = [];
                    $(".selectAdmin").each(function () {
                        var activo = $(this).parent().hasClass("off");
                        if (activo == false) {
                            admin.push($(this).val());
                        }
                        admin2.push($(this).val());
                    });

                    for (let i = 0; i < admin2.length; i++) {
                        $(".inm_" + admin2[i]).hide();
                    }

                    if (!$("#divInmuebles > #btnInmueble").hasClass("show")) {
                        $(".btnInmuebles").trigger("click");
                    }

                    if (admin.length > 0) {
                        for (let i = 0; i < admin.length; i++) {
                            $(".inm_" + admin[i]).show();
                        }
                    } else {
                        for (let i = 0; i < admin2.length; i++) {
                            $(".inm_" + admin2[i]).show();
                        }
                    }
                }

                if (model.filtroInmuebles != "") {
                    inmuebles = [];
                    $(".selectInmueble").each(function () {
                        var activo = $(this).parent().hasClass("off");
                        if (activo == false) {
                            inmuebles.push($(this).val());
                        }
                    });
                    console.log(inmuebles);
                    var mergedVal = inmuebles.join('|').replace("&", "\\&").replace(/\s/g, "\\s");
                    table.column(2).search(mergedVal, true).draw();
                }

                if (model.filtroEstatus != "") {
                    est = [];
                    $(".selectEstatus").each(function () {
                        var activo = $(this).parent().hasClass("off");
                        if (activo == false) {
                            est.push($(this).val());
                        }
                    });
                    console.log(est);
                    var mergedVal = est.join('|').replace("&", "\\&").replace(/\s/g, "\\s");
                    table.column(1).search(mergedVal, true).draw();
                }
            /********************************** FIN Filtro Ajax*********************************/

            function cuentaTramites() {
                var c = 0;
                for (var i = 0; i < model.length; i++) {
                    if (model[i].estatus == "En Trámite") {
                        return 1;
                    }
                }
            }

            $(document).on("click", ".delete_cedula", function () {
                var id = $(this).data("id");
                var folio = $(this).data("folio");

                Swal.fire({
                    'icon': 'warning',
                    'title': 'Servicio de Transporte de Personal',
                    'html': '¿Estás seguro de eliminar la cédula con folio: ' + folio + '?',
                    'confirmButtonColor': '#3085d6',
                    'cancelButtonColor': '#d33',
                    'confirmButtonText': 'Si, Eliminar Cédula',
                    'cancelButtonText': 'Cancelar',
                    'showCancelButton': true
                }).then(response => {
                    if (response.isConfirmed) {
                        axios.get("/transporte/eliminar/" + id).then(response => {
                            if (response.status == 200) {
                                Swal.fire({
                                    'title': 'Servicio de Transporte de Personal y Fauna Nociva',
                                    'html': 'La cédula fue eliminada con éxito.',
                                    'icon': 'success'
                                }).then(function () {
                                    window.location.reload();
                                });
                            }
                        }).catch(error => {
                            Swal.fire({
                                'title': 'Servicio de Transporte de Personal',
                                'html': 'No se eliminó la cédula fue eliminada. Contacte al administrador del sistema.',
                                'icon': 'error'
                            });
                        });
                    }
                });
            });

            $('.btn_pdf').click(function () {
                let id = $(this).data('id');
                let estatus = $(this).data('estatus');
                let inmueble = $(this).data('inmueble');


                if (estatus == 'Autorizada') {
                    Swal.fire({
                        'icon': 'info',
                        'title': 'Servicio de Transporte de Personal',
                        'html': '<p style="text-align: justify">La cédula de evaluación ya fue autorizada, no olvide firmarla electrónicamente y ' +
                            'posteriormente <strong>subirla en el sistema CASESGV2 en el apartado de "Seguimiento a la Cédula"</strong>, si tiene alguna duda por favor ' +
                            'comuníquese a la ext. 2574 o 2635. </p>'
                    }).then(function () {
                        firmaReviso(inmueble, id);
                    });
                } else {
                    firmaReviso(inmueble, id);
                }
            });


            $('.btn_pdfNC').click(function () {
                let id = $(this).data('id');
                let estatus = $(this).data('estatus');
                let inmueble = $(this).data('inmueble');


                if (estatus == 'Autorizada') {
                    Swal.fire({
                        'icon': 'info',
                        'title': 'Servicio de Transporte de Personal',
                        'html': '<p style="text-align: justify">La cédula de evaluación ya fue autorizada, no olvide firmarla electrónicamente y ' +
                            'posteriormente <strong>subirla en el sistema CASESGV2 en el apartado de "Seguimiento a la Cédula"</strong>, si tiene alguna duda por favor ' +
                            'comuníquese a la ext. 2574 o 2635. </p>'
                    }).then(function () {
                        firmaRevisoNC(inmueble, id);
                    });
                } else {
                    firmaRevisoNC(inmueble, id);
                }
            });


            function firmaReviso(inmueble, id) {
                var firmante = new Array();
                axios.get('/firmantes/verificaFirmante/Reviso/' + inmueble + '/' + model.servicioId+'/'+id).then(review => {
                    if (review.data == 0) {
                        Swal.fire({
                            'icon': 'warning',
                            'title': 'Servicio de Transporte de Personal',
                            'html': '<p style="text-align: justify;">Aún no captura al personal que se encarga de firmar el apartado <b>"Revisó"</b> dentró de la cédula de acuerdo al servicio de la administración/inmueble al que pertenece. ' +
                                'Por favor seleccione al personal que firmará dicho apartado, previo a la impresión.</p><div class="select2-purple col-lg-12" style="text-align: justify">' +
                                '<p class="font-weight-bold" style="font-size: 16px;">¿Quién revisa la cédula?:</p>' +
                                '<select class= "form-control select2bs4" data-dropdown-css-class="select2-purple" id = "usrReviso" > ' + obtieneFirmantes() + '</select >' +
                                '</div>',
                            'confirmButtonColor': '#3085d6',
                            'cancelButtonColor': '#d33',
                            'confirmButtonText': 'Registrar',
                            'cancelButtonText': 'Cancelar',
                            'showCancelButton': true
                        }).then(confirm => {
                            var user = $("#usrReviso").val();
                            var name = $("#usrReviso :selected").text();
                            if (user != "" && confirm.isConfirmed) {
                                Swal.fire({
                                    'icon': 'warning',
                                    'title': 'Servicio de Transporte de Personal',
                                    'html': '<p style="text-align: justify">Para confirmar que <b>' + name + '</b> firmará electrónicamente (FIREL) la cédula en el apartado <b>"Revisó"</b>, deberá escribir la palabra CONFIRMAR.</p>',
                                    'confirmButtonColor': '#3085d6',
                                    'cancelButtonColor': '#d33',
                                    'confirmButtonText': 'Guardar',
                                    'cancelButtonText': 'Cancelar',
                                    'showCancelButton': true,
                                    'input': 'text',
                                    'inputPlaceholder': 'Escribe la palabra CONFIRMAR'
                                }).then(confirma => {
                                    if (confirma.value == "CONFIRMAR") {
                                        axios.post('/firmantes/insertaFirmante', { InmuebleId: parseInt(inmueble), ServicioId: parseInt(model.servicioId), UsuarioId: parseInt(user), Tipo: "Reviso" }).then(revisa => {
                                            if (revisa.data != -1) {
                                                Swal.fire({
                                                    'icon': 'success',
                                                    'title': 'Servicio de Transporte de Personal',
                                                    'html': '<p style="text-align: justify">El encargado de <b>Revisar</b> la cédula se capturó correctamente. </p>'
                                                }).then(function () {
                                                    firmaSuperviso(inmueble, id);
                                                });
                                            }
                                        });
                                    }
                                });
                            } else {
                                Swal.fire({
                                    'icon': 'error',
                                    'title': 'Servicio de Transporte de Personal',
                                    'html': '<p style="text-align: justify">No es posible descargar la cédula si el nombre del encargado de <b>Revisar</b> la misma no está registrado. </p>'
                                })
                            }
                        });
                    } else {
                        firmaSuperviso(inmueble, id);
                    }
                }).catch(error => {
                    Swal.fire({
                        'icon': 'info',
                        'title': 'Servicio de Transporte de Personal',
                        'html': '<p style="text-align: justify">Hubo un error al registrar a la persona que revisará la cédula. Por favor comuníquese a la ext. 2574 o 2635. </p>' + error
                    });
                });
            }

            function firmaRevisoNC(inmueble, id) {
                var firmante = new Array();
                axios.get('/firmantes/verificaFirmante/Reviso/' + inmueble + '/' + model.servicioId + '/' + id).then(review => {
                    if (review.data == 0) {
                        Swal.fire({
                            'icon': 'warning',
                            'title': 'Servicio de Transporte de Personal',
                            'html': '<p style="text-align: justify;">Aún no captura al personal que se encarga de firmar el apartado <b>"Revisó"</b> dentró de la cédula de acuerdo al servicio de la administración/inmueble al que pertenece. ' +
                                'Por favor seleccione al personal que firmará dicho apartado, previo a la impresión.</p><div class="select2-purple col-lg-12" style="text-align: justify">' +
                                '<p class="font-weight-bold" style="font-size: 16px;">¿Quién revisa la cédula?:</p>' +
                                '<select class= "form-control select2bs4" data-dropdown-css-class="select2-purple" id = "usrReviso" > ' + obtieneFirmantes() + '</select >' +
                                '</div>',
                            'confirmButtonColor': '#3085d6',
                            'cancelButtonColor': '#d33',
                            'confirmButtonText': 'Registrar',
                            'cancelButtonText': 'Cancelar',
                            'showCancelButton': true
                        }).then(confirm => {
                            var user = $("#usrReviso").val();
                            var name = $("#usrReviso :selected").text();
                            if (user != "" && confirm.isConfirmed) {
                                Swal.fire({
                                    'icon': 'warning',
                                    'title': 'Servicio de Transporte de Personal',
                                    'html': '<p style="text-align: justify">Para confirmar que <b>' + name + '</b> firmará electrónicamente (FIREL) la cédula en el apartado <b>"Revisó"</b>, deberá escribir la palabra CONFIRMAR.</p>',
                                    'confirmButtonColor': '#3085d6',
                                    'cancelButtonColor': '#d33',
                                    'confirmButtonText': 'Guardar',
                                    'cancelButtonText': 'Cancelar',
                                    'showCancelButton': true,
                                    'input': 'text',
                                    'inputPlaceholder': 'Escribe la palabra CONFIRMAR'
                                }).then(confirma => {
                                    if (confirma.value == "CONFIRMAR") {
                                        axios.post('/firmantes/insertaFirmante', { InmuebleId: parseInt(inmueble), ServicioId: parseInt(model.servicioId), UsuarioId: parseInt(user), Tipo: "Reviso" }).then(revisa => {
                                            if (revisa.data != -1) {
                                                Swal.fire({
                                                    'icon': 'success',
                                                    'title': 'Servicio de Transporte de Personal',
                                                    'html': '<p style="text-align: justify">El encargado de <b>Revisar</b> la cédula se capturó correctamente. </p>'
                                                }).then(function () {
                                                    firmaSupervisoNC(inmueble, id);
                                                });
                                            }
                                        });
                                    }
                                });
                            } else {
                                Swal.fire({
                                    'icon': 'error',
                                    'title': 'Servicio de Transporte de Personal',
                                    'html': '<p style="text-align: justify">No es posible descargar la cédula si el nombre del encargado de <b>Revisar</b> la misma no está registrado. </p>'
                                })
                            }
                        });
                    } else {
                        firmaSupervisoNC(inmueble, id);
                    }
                }).catch(error => {
                    Swal.fire({
                        'icon': 'info',
                        'title': 'Servicio de Transporte de Personal',
                        'html': '<p style="text-align: justify">Hubo un error al registrar a la persona que revisará la cédula. Por favor comuníquese a la ext. 2574 o 2635. </p>' + error
                    });
                });
            }

            function firmaSuperviso(inmueble, id) {
                var firmante = new Array();
                axios.get('/firmantes/verificaFirmante/Superviso/' + inmueble + '/' + model.servicioId+'/'+id).then(review => {
                    if (review.data == 0) {
                        Swal.fire({
                            'icon': 'warning',
                            'title': 'Servicio de Transporte de Personal',
                            'html': '<p style="text-align: justify;">Aún no captura al personal que se encarga de firmar el apartado <b>"Supervisó"</b> dentró de la cédula de acuerdo al servicio de la administración/inmueble al que pertenece. ' +
                                'Por favor seleccione al personal que firmará dicho apartado, previo a la impresión.</p><div class="select2-purple col-lg-12" style="text-align: justify">' +
                                '<p class="font-weight-bold" style="font-size: 16px;">¿Quién supervisa la cédula?:</p>' +
                                '<select class= "form-control select2bs4" data-dropdown-css-class="select2-purple" id = "usrSuperviso" > ' + obtieneFirmantes() + '</select >' +
                                '</div>',
                            'confirmButtonColor': '#3085d6',
                            'cancelButtonColor': '#d33',
                            'confirmButtonText': 'Registrar',
                            'cancelButtonText': 'Cancelar',
                            'showCancelButton': true
                        }).then(confirm => {
                            var user = $("#usrSuperviso").val();
                            var name = $("#usrSuperviso :selected").text();
                            if (user != "" && confirm.isConfirmed) {
                                Swal.fire({
                                    'icon': 'warning',
                                    'title': 'Servicio de Transporte de Personal',
                                    'html': '<p style="text-align: justify">Para confirmar que <b>' + name + '</b> firmará electrónicamente (FIREL) la cédula en el apartado <b>"Supervisó"</b>, deberá escribir la palabra CONFIRMAR.</p>',
                                    'confirmButtonColor': '#3085d6',
                                    'cancelButtonColor': '#d33',
                                    'confirmButtonText': 'Guardar',
                                    'cancelButtonText': 'Cancelar',
                                    'showCancelButton': true,
                                    'input': 'text',
                                    'inputPlaceholder': 'Escribe la palabra CONFIRMAR'
                                }).then(supervisa => {
                                    if (supervisa.value == "CONFIRMAR") {
                                        axios.post('/firmantes/insertaFirmante', { InmuebleId: parseInt(inmueble), ServicioId: parseInt(model.servicioId), UsuarioId: parseInt(user), Tipo: "Superviso" }).then(supervisa => {
                                            if (supervisa.data != -1) {
                                                Swal.fire({
                                                    'icon': 'success',
                                                    'title': 'Servicio de Transporte de Personal',
                                                    'html': '<p style="text-align: justify">El encargado de <b>Supervisar</b> la cédula se capturó correctamente. </p>'
                                                }).then(function () {
                                                    window.open('/cedula/transporte/' + model.servicioId + '/' + id, '_blank');
                                                });
                                            }
                                        });
                                    }
                                });
                            } else {
                                Swal.fire({
                                    'icon': 'error',
                                    'title': 'Servicio de Transporte de Personal',
                                    'html': '<p style="text-align: justify">No es posible descargar la cédula si el nombre del encargado de <b>Supervisar</b> la misma no está registrado. </p>'
                                })
                            }
                        });
                    } else {
                        window.open('/cedula/transporte/' + model.servicioId + '/' + id, '_blank');
                    }
                }).catch(error => {
                    Swal.fire({
                        'icon': 'info',
                        'title': 'Servicio de Transporte de Personal',
                        'html': '<p style="text-align: justify">Hubo un error al registrar a la persona que revisará la cédula. Por favor comuníquese a la ext. 2574 o 2635. </p>'
                    })
                });
            }

            function firmaSupervisoNC(inmueble, id) {
                var firmante = new Array();
                axios.get('/firmantes/verificaFirmante/Superviso/' + inmueble + '/' + model.servicioId + '/' + id).then(review => {
                    if (review.data == 0) {
                        Swal.fire({
                            'icon': 'warning',
                            'title': 'Servicio de Transporte de Personal',
                            'html': '<p style="text-align: justify;">Aún no captura al personal que se encarga de firmar el apartado <b>"Supervisó"</b> dentró de la cédula de acuerdo al servicio de la administración/inmueble al que pertenece. ' +
                                'Por favor seleccione al personal que firmará dicho apartado, previo a la impresión.</p><div class="select2-purple col-lg-12" style="text-align: justify">' +
                                '<p class="font-weight-bold" style="font-size: 16px;">¿Quién supervisa la cédula?:</p>' +
                                '<select class= "form-control select2bs4" data-dropdown-css-class="select2-purple" id = "usrSuperviso" > ' + obtieneFirmantes() + '</select >' +
                                '</div>',
                            'confirmButtonColor': '#3085d6',
                            'cancelButtonColor': '#d33',
                            'confirmButtonText': 'Registrar',
                            'cancelButtonText': 'Cancelar',
                            'showCancelButton': true
                        }).then(confirm => {
                            var user = $("#usrSuperviso").val();
                            var name = $("#usrSuperviso :selected").text();
                            if (user != "" && confirm.isConfirmed) {
                                Swal.fire({
                                    'icon': 'warning',
                                    'title': 'Servicio de Transporte de Personal',
                                    'html': '<p style="text-align: justify">Para confirmar que <b>' + name + '</b> firmará electrónicamente (FIREL) la cédula en el apartado <b>"Supervisó"</b>, deberá escribir la palabra CONFIRMAR.</p>',
                                    'confirmButtonColor': '#3085d6',
                                    'cancelButtonColor': '#d33',
                                    'confirmButtonText': 'Guardar',
                                    'cancelButtonText': 'Cancelar',
                                    'showCancelButton': true,
                                    'input': 'text',
                                    'inputPlaceholder': 'Escribe la palabra CONFIRMAR'
                                }).then(supervisa => {
                                    if (supervisa.value == "CONFIRMAR") {
                                        axios.post('/firmantes/insertaFirmante', { InmuebleId: parseInt(inmueble), ServicioId: parseInt(model.servicioId), UsuarioId: parseInt(user), Tipo: "Superviso" }).then(supervisa => {
                                            if (supervisa.data != -1) {
                                                Swal.fire({
                                                    'icon': 'success',
                                                    'title': 'Servicio de Transporte de Personal',
                                                    'html': '<p style="text-align: justify">El encargado de <b>Supervisar</b> la cédula se capturó correctamente. </p>'
                                                }).then(function () {
                                                    window.open('/cedula/transporteNC/' + model.servicioId + '/' + id, '_blank');
                                                });
                                            }
                                        });
                                    }
                                });
                            } else {
                                Swal.fire({
                                    'icon': 'error',
                                    'title': 'Servicio de Transporte de Personal',
                                    'html': '<p style="text-align: justify">No es posible descargar la cédula si el nombre del encargado de <b>Supervisar</b> la misma no está registrado. </p>'
                                })
                            }
                        });
                    } else {
                        window.open('/cedula/transporteNC/' + model.servicioId + '/' + id, '_blank');
                    }
                }).catch(error => {
                    Swal.fire({
                        'icon': 'info',
                        'title': 'Servicio de Transporte de Personal',
                        'html': '<p style="text-align: justify">Hubo un error al registrar a la persona que revisará la cédula. Por favor comuníquese a la ext. 2574 o 2635. </p>'
                    })
                });
            }

            /********************************** Funciones Adicionales *********************************/
            function obtieneFirmantes() {
                let reviso = "<option value=''>Seleccione un empleado</option>";
                $.ajax({
                    url: '/firmantes/obtieneFirmantes/' + idUsuario,
                    type: 'GET',
                    async: false,
                    success: function (json) {
                        json.forEach(function (usr) {
                            reviso += "<option value=" + usr.id + ">" + usr.nombreCompleto + "</option>"
                        });
                    },
                });
                return reviso;
            }

            /********************************** FIN Funciones Asincronas*********************************/

        });

        //$(document).ready(function () {
        //    var miModal = $('#miModal'); // Selecciona tu modal por su ID
        //    var claveLocalStorage = 'modalImportanteLimitado'; // Clave única para este modal
        //    var limiteApariciones = 3; // Define el número máximo de veces que quieres que aparezca

        //    // Recupera la información guardada en localStorage
        //    var modalInfoStr = localStorage.getItem(claveLocalStorage);
        //    // Parsea la información o inicialízala si no existe
        //    var modalInfo = modalInfoStr ? JSON.parse(modalInfoStr) : { contador: 0 };

        //    // Verifica si el modal se ha mostrado menos veces que el límite establecido
        //    if (modalInfo.contador < limiteApariciones) {
        //        miModal.modal('show'); // Muestra el modal de Bootstrap
        //        modalInfo.contador++; // Incrementa el contador de apariciones
        //        // Guarda la información actualizada en localStorage
        //        localStorage.setItem(claveLocalStorage, JSON.stringify(modalInfo));
        //    }
        //});
    </script>
}

